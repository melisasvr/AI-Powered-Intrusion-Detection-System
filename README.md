# AI-Powered Intrusion Detection System
This project implements an AI-Powered Intrusion Detection System (IDS) using deep learning to detect potential network intrusions. The system processes network packet data, extracts relevant features, and uses a hybrid CNN-LSTM model to classify packets as normal (0) or malicious (1). The project includes two main scripts:
- `generate_dataset.py`: Generates a synthetic dataset (dataset.csv) with random network packet features and labels for testing purposes.
- `deep_learning_ids.py`: Trains a deep learning model on a dataset and supports real-time packet capture and monitoring for intrusion detection.
- The current implementation uses a synthetic dataset for testing, but it can be adapted to real network traffic data or public datasets (e.g., CICIDS2017) for practical use.

## Requirements
1. To run the project, you need the following:
- Python 3.8+
- Required Python libraries:
- `pip install torch numpy pandas scapy scikit-learn`
- Npcap (for Windows, required for real-time packet capture in --monitor mode):
- Download and install from https://npcap.com/.
- Required for scapy to capture packets.
- Operating System: Tested on Windows; should work on Linux/Mac with minor adjustments (e.g., replace Npcap with libpcap on Linux).

## Project Structure
- `generate_dataset.py`: Script to create a synthetic dataset (dataset.csv) with 1000 samples and 15 columns (14 features + 1 label).
- `deep_learning_ids.py`: Main script for training the IDS model and monitoring network traffic.
- `dataset.csv`: Synthetic dataset generated by generate_dataset.py (used for testing).
- `ids_model.pt`: Saved trained model (generated after training).
- `ids_scaler.pkl`: Saved scaler for feature normalization (generated after training).
- `feature_columns.pkl`: Saved feature column names (generated after training).


## Usage
1. Generate a Synthetic Dataset
To create a synthetic dataset for testing:
- python generate_dataset.py
- Output: Creates dataset.csv with 1000 samples of random packet data.
- Note: This dataset is for testing only. The random labels mean the trained model won’t be effective for real intrusion detection.

2. Train the Model
- To train the IDS model using dataset.csv:
- python deep_learning_ids.py --train --dataset dataset.csv
- Output:
- Loads dataset.csv and trains a hybrid CNN-LSTM model.
- Displays training and validation loss/accuracy for each epoch.
- Saves the trained model (ids_model.pt), scaler (ids_scaler.pkl), and feature columns (feature_columns.pkl).
- Training may stop early if validation loss doesn’t improve (early stopping).
- Example Output:
```Loading dataset from dataset.csv
Dataset loaded: 1000 samples, 14 features
Using device: cpu
Epoch 1/25 - train_loss: 0.6959 - train_acc: 0.4925 - val_loss: 0.6940 - val_acc: 0.4850
...
Early stopping triggered
Model saved to ids_model.pt
```
3. Monitor Network Traffic
- To use the trained model for real-time packet capture and intrusion detection:
- `python deep_learning_ids.py --monitor`
- Requirements:
- Npcap must be installed for packet capture.
- The trained model files (ids_model.pt, ids_scaler.pkl, feature_columns.pkl) must exist.
- Output:
- Captures packets on the specified interface (or all interfaces if none specified).
- Analyzes packets and prints alerts for detected intrusions:
- `ALERT: Potential intrusion detected! Confidence: 0.XXXX`
- Stop Monitoring:
- Press Ctrl+C to stop the IDS.
- Optional: Specify a network interface (e.g., Ethernet):
- `python deep_learning_ids.py --monitor --interface Ethernet`

- To find your interface name, use:
- from scapy.all import get_if_list
- print(get_if_list())

4. Notes on Synthetic Data
- The dataset.csv generated by generate_dataset.py contains random data and labels, suitable for testing the script’s functionality but not for real-world intrusion detection.
- For practical use, replace dataset.csv with a real dataset containing labeled network traffic (e.g., CICIDS2017, NSL-KDD).
- Ensure any real dataset matches the 15-column format described above.

5. Using Real Data
- To train the IDS with real data:
- Obtain a Dataset:
- Use a public dataset like CICIDS2017 or capture your own traffic using Wireshark or the script’s --monitor mode (after installing Npcap).
- Label the data (0 for normal, 1 for attack) and format it to match the 15-column structure.
- Preprocess the Data:
- Convert the dataset to CSV with the required columns.
- Example preprocessing tools: Python with pandas, or export from Wireshark.
- Train with Real Data:
- `python deep_learning_ids.py --train --dataset real_dataset.csv`
- Monitor with the Trained Model:
- `python deep_learning_ids.py --monitor`

## License
- This project is licensed under the MIT License. Feel free to use, modify, and distribute it.


